<!DOCTYPE html>  <!-- Tells browser this is an HTML5 document -->
<html>           <!-- Root element that wraps entire page -->
<head>           <!-- Contains page metadata and styling -->
    <title>Custom Design Generator</title>  <!-- Page title shown in browser tab -->
    <style>      
        /* ============ UNIVERSAL RESET ============ */
        * {
            margin: 0;      /* Remove default margins from all HTML elements */
            padding: 0;     /* Remove default padding from all HTML elements */
            box-sizing: border-box;  /* Include borders and padding in width/height calculations */
        }

        /* ============ BODY STYLING ============ */
        body {
            font-family: Arial, sans-serif;  /* Set font type to Arial or fallback to sans-serif */
            background: linear-gradient(135deg, #2c3e50 0%, #4b6584 100%);  /* Gradient background: dark blue to lighter blue at 135° angle */
            min-height: 100vh;      /* Make body at least full viewport height (vh = viewport height) */
            display: flex;          /* Use flexbox layout for centering content */
            justify-content: center;  /* Center content horizontally */
            align-items: center;    /* Center content vertically */
            padding: 20px;          /* Add 20px space around edges for mobile devices */
            direction: rtl;         /* Right-to-left text direction (for Arabic language) */
            text-align: right;      /* Align text to the right side (for Arabic) */
        }

        /* ============ CONTAINER BOX ============ */
        .container {
            background: white;      /* White background for the main box */
            border-radius: 10px;    /* Round corners by 10px */
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);  /* Drop shadow: offset 10px down, 40px blur, 20% black opacity */
            padding: 40px;          /* 40px space inside the box (margin inside) */
            max-width: 600px;       /* Maximum width of 600px (won't grow larger) */
            width: 100%;            /* Use 100% of available width (up to max-width) */
        }

        /* ============ HEADINGS ============ */
        h1 {
            text-align: center;  /* Center the heading */
            color: #2c3e50;      /* Heading color: dark blue */
            margin-bottom: 30px; /* 30px space below the heading */
        }

        /* ============ FORM GROUPS & LABELS ============ */
        .form-group {
            margin-bottom: 25px;  /* 25px space between form sections */
        }

        label {
            display: block;       /* Make label take full width */
            margin-bottom: 8px;   /* 8px space between label and input */
            color: #333;          /* Dark gray text color */
            font-weight: bold;    /* Make text bold/thick */
        }

        /* ============ TEXT INPUT STYLING ============ */
        input[type="text"] {
            width: 100%;            /* Input takes full width of container */
            padding: 12px;          /* 12px space inside the input */
            border: 2px solid #cfd6df;  /* 2px gray border */
            border-radius: 5px;     /* Slightly rounded corners */
            font-size: 16px;        /* Text size 16px */
            transition: border-color 0.3s;  /* Smooth color change over 0.3 seconds */
        }

        input[type="text"]:focus {  /* When input is clicked/focused */
            outline: none;          /* Remove default blue outline */
            border-color: #4b6584;  /* Change border to dark blue */
        }

        /* ============ DESIGN OPTIONS GRID ============ */
        .design-options {
            display: grid;              /* Use CSS grid layout */
            grid-template-columns: 1fr 1fr;  /* Two equal columns (1fr = 1 fraction) */
            gap: 20px;                  /* 20px space between grid items */
            margin-bottom: 25px;        /* 25px space below grid */
        }

        .design-option {
            position: relative;   /* Allow absolute positioning of child elements */
            cursor: pointer;      /* Change cursor to hand when hovering */
        }

        .design-option input[type="radio"] {
            position: absolute;   /* Hide radio button (place it absolutely) */
            opacity: 0;           /* Make it invisible (0% opacity) */
            cursor: pointer;      /* Cursor still shows pointer */
        }

        /* ============ DESIGN PREVIEW BOXES ============ */
        .design-preview {
            width: 100%;            /* Full width of grid cell */
            height: 150px;          /* 150px height */
            border: 3px solid #ddd; /* 3px light gray border */
            border-radius: 8px;     /* Rounded corners 8px */
            display: flex;          /* Flexbox layout for centering text */
            align-items: center;    /* Center items vertically */
            justify-content: center;  /* Center items horizontally */
            font-weight: bold;      /* Bold text */
            color: white;           /* White text color */
            font-size: 18px;        /* Text size 18px */
            transition: all 0.3s;   /* Smooth animation for all properties over 0.3s */
            cursor: pointer;        /* Hand cursor on hover */
            background-size: cover;       /* Cover entire area with image */
            background-position: center;  /* Center the image */
        }

        .design-option input[type="radio"]:checked + .design-preview {
            /* Styles when radio button is selected */
            border-color: #667eea;      /* Change border to blue */
            transform: scale(1.05);     /* Make box 5% larger */
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);  /* Add blue glow shadow */
        }

        /* ============ DESIGN IMAGES ============ */
        .design1 {
            /* Load design1.jpg image from GitHub repository */
            background-image: url('https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design1.jpg');
            background-size: cover;        /* Stretch image to cover entire area */
            background-position: center;   /* Center the image */
        }

        .design2 {
            /* Load design2.jpg image from GitHub repository */
            background-image: url('https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design2.jpg');
            background-size: cover;        /* Stretch image to cover entire area */
            background-position: center;   /* Center the image */
        }

        /* ============ BUTTON STYLING ============ */
        .button-group {
            display: flex;    /* Place buttons in a row */
            gap: 10px;        /* 10px space between buttons */
            margin-bottom: 25px;  /* 25px space below button group */
        }

        button {
            flex: 1;                    /* Each button takes equal space */
            padding: 12px;              /* 12px space inside button */
            font-size: 16px;            /* Text size 16px */
            font-weight: bold;          /* Bold text */
            border: none;               /* Remove default border */
            border-radius: 5px;         /* Rounded corners 5px */
            cursor: pointer;            /* Hand cursor on hover */
            transition: all 0.3s;       /* Smooth animation for all changes */
        }

        .btn-done {
            background: #4b6584;  /* Dark blue background */
            color: white;         /* White text */
        }

        .btn-done:hover {
            background: #3b5770;        /* Darker blue on hover */
            transform: translateY(-2px); /* Move up 2px when hovering */
        }

        .btn-reset {
            background: #e0e0e0;  /* Light gray background */
            color: #333;          /* Dark gray text */
        }

        .btn-reset:hover {
            background: #d5d5d5;  /* Slightly darker gray on hover */
        }

        /* ============ PREVIEW SECTION ============ */
        .preview-section {
            display: none;              /* Hidden by default */
            text-align: center;         /* Center all content */
            padding: 30px;              /* 30px space inside */
            background: #f4f6f8;        /* Light blue-gray background */
            border-radius: 8px;         /* Rounded corners 8px */
        }

        .preview-section.active {
            display: block;  /* Show when .active class is added by JavaScript */
        }

        /* ============ PREVIEW IMAGE ============ */
        .preview-image {
            width: 100%;            /* Full width */
            max-width: 400px;       /* But maximum 400px */
            height: 300px;          /* 300px height (final image size) */
            display: flex;          /* Flexbox for centering text */
            align-items: center;    /* Center items vertically */
            justify-content: center;  /* Center items horizontally */
            border-radius: 8px;     /* Rounded corners 8px */
            margin: 20px auto;      /* 20px space above/below, auto horizontal margin */
            font-size: 48px;        /* Large text size for name */
            font-weight: bold;      /* Bold text */
            color: white;           /* White text color */
            position: relative;     /* For positioning child elements */
            background-size: cover;       /* Cover entire area with image */
            background-position: center;  /* Center the image */
        }

        .preview-image.design1 {
            /* Load design1.jpg for preview */
            background-image: url('https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design1.jpg');
            background-size: cover;
            background-position: center;
        }

        .preview-image.design2 {
            /* Load design2.jpg for preview */
            background-image: url('https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design2.jpg');
            background-size: cover;
            background-position: center;
        }

        .preview-name {
            font-size: 32px;      /* Large text size for name */
            font-weight: bold;    /* Bold text */
        }

        /* ============ DOWNLOAD & BACK BUTTONS ============ */
        .btn-download {
            background: #6a8f7b;  /* Green background */
            color: white;         /* White text */
            margin-top: 20px;     /* 20px space above button */
        }

        .btn-download:hover {
            background: #5c7f6d;        /* Darker green on hover */
            transform: translateY(-2px); /* Move up 2px on hover */
        }

        .btn-back {
            background: #7a7a7a;  /* Gray background */
            color: white;         /* White text */
            margin-top: 10px;     /* 10px space above button */
        }

        .btn-back:hover {
            background: #666;     /* Darker gray on hover */
        }

        /* ============ ERROR MESSAGES ============ */
        .error {
            color: #f5576c;   /* Red text color */
            font-size: 14px;  /* Small text size */
            margin-top: 5px;  /* 5px space above error */
        }

        .hidden {
            display: none;  /* Hide element */
        }
    </style>                                                          <!-- End of CSS styling -->
</head>                                                              <!-- End of page head section -->

<body>                                                               <!-- Start of visible page content -->
    <!-- ===== MAIN CONTAINER ===== -->
    <div class="container">                                          <!-- White box container -->
        
        <!-- ===== FORM SECTION (Input & Design Selection) ===== -->
        <div class="form-section active" id="formSection">           <!-- Initially visible form -->
            <h1>صمّم بطاقة تهنئة العيد باسمك</h1>                      <!-- Title: "Design an Eid greeting with your name" -->

            <!-- ===== NAME INPUT ===== -->
            <div class="form-group">                                 <!-- Group for name input -->
                <label for="userName">الاسم:</label>                  <!-- Label: "Name:" -->
                <input type="text" id="userName" placeholder="اكتب اسمك هنا ...">  <!-- Text input field, ID for JavaScript -->
                <!-- Placeholder text: "Type your name here..." -->
                <div class="error" id="nameError"></div>             <!-- Error message area (empty initially) -->
            </div>

            <!-- ===== DESIGN SELECTION ===== -->
            <div class="form-group">                                 <!-- Group for design choices -->
                <label>اختر تصميم التهنئة:</label>                     <!-- Label: "Choose a design:" -->
                <div class="design-options">                         <!-- Grid container for 2 design options -->
                    
                    <!-- Design 1 Option -->
                    <div class="design-option">                      <!-- First design option -->
                        <input type="radio" id="design1" name="design" value="design1">
                        <!-- Radio button: name="design" means all radios in group are linked, value="design1" -->
                        <label for="design1" class="design-preview design1"></label>
                        <!-- Label shows design1.jpg image, text says "Design 1" -->
                    </div>
                    
                    <!-- Design 2 Option -->
                    <div class="design-option">                      <!-- Second design option -->
                        <input type="radio" id="design2" name="design" value="design2">
                        <!-- Radio button for design 2 -->
                        <label for="design2" class="design-preview design2"> </label>
                        <!-- Label shows design2.jpg image, text says "Design 2" -->
                    </div>
                </div>
                <div class="error" id="designError"></div>            <!-- Error message area (empty initially) -->
            </div>

            <!-- ===== ACTION BUTTONS ===== -->
            <div class="button-group">                               <!-- Container for form buttons -->
                <button class="btn-done" onclick="generateDesign()">إنشاء التهنئة</button>
                <!-- Create button: onclick calls generateDesign() function when clicked -->
                <!-- Text: "Create" -->
                <button class="btn-reset" onclick="resetForm()">إعادة تعيين</button>
                <!-- Reset button: onclick calls resetForm() to clear inputs -->
                <!-- Text: "Reset" -->
            </div>
        </div>

        <!-- ===== PREVIEW SECTION (Shows after Create is clicked) ===== -->
        <div class="preview-section" id="previewSection">            <!-- Hidden by default, shown when .active class added -->
            <h1>تهنئتك جاهزة</h1>                                      <!-- Title: "Your greeting is ready" -->
            
            <!-- ===== PREVIEW IMAGE ===== -->
            <div class="preview-image" id="previewImage">            <!-- Shows selected design image -->
                <div class="preview-name" id="previewName"></div>    <!-- User's name displayed on image (JavaScript fills this) -->
            </div>
            
            <!-- ===== DOWNLOAD & BACK BUTTONS ===== -->
            <button class="btn-download" onclick="downloadImage()">تنزيل الصورة</button>
            <!-- Download button: onclick calls downloadImage() function -->
            <!-- Text: "Download Image" -->
            <button class="btn-back" onclick="goBack()">إنشاء تهنئة أخرى</button>
            <!-- Back button: onclick calls goBack() to return to form -->
            <!-- Text: "Create Another" -->
        </div>
    </div>

    <script>
        <!-- ===== FUNCTION: Generate/Create Design ===== -->
        function generateDesign() {
            // Get the name user typed in the input field
            const name = document.getElementById('userName').value.trim();
            // .trim() removes extra spaces before and after the name
            
            // Get which design is selected (design1 or design2)
            const design = document.querySelector('input[name="design"]:checked').value;
            // querySelector finds the radio button that is :checked and gets its value
            
            // Get the error message element
            const nameError = document.getElementById('nameError');
            
            // Clear any previous error messages
            nameError.textContent = '';
            
            // Check if name is empty (validation)
            if (!name) {
                // Show error message to user
                nameError.textContent = 'فضلًا قم بكتابة الاسم';
                // Stop the function (don't continue to preview)
                return;
            }
            
            // Hide the form section (hide input fields)
            document.getElementById('formSection').style.display = 'none';
            
            // Show the preview section (show image and download button)
            document.getElementById('previewSection').classList.add('active');
            // Adding 'active' class triggers CSS display: block
            
            // Get the preview image element
            const previewImage = document.getElementById('previewImage');
            
            // Get the preview name element
            const previewName = document.getElementById('previewName');
            
            // Set the class to show the correct design image
            previewImage.className = 'preview-image ' + design;
            // If design='design1', className becomes 'preview-image design1'
            // CSS will load design1.jpg background image
            
            // Display the user's name on the preview
            previewName.textContent = name;
        }

     
        function resetForm() {
            // Clear the name input field
            document.getElementById('userName').value = '';
            // .value = '' removes all text from the input
            
            // Set Design 1 as checked (selected)
            document.getElementById('design1').checked = true;
            // This makes the design1 radio button selected
            
            // Clear any error messages
            document.getElementById('nameError').textContent = '';
            // textContent = '' removes error message text
        }

      
        function goBack() {
            // Remove the 'active' class to hide preview section
            document.getElementById('previewSection').classList.remove('active');
            // Removing 'active' class triggers CSS display: none
            
            // Show the form section again
            document.getElementById('formSection').style.display = 'block';
            
            // Clear all form inputs
            resetForm();
            // Call resetForm() to clear name, reset design, and clear errors
        }


        function downloadImage() {
            // Get the preview image element to know which design is selected
            const previewImage = document.getElementById('previewImage');
            
            // Create a blank canvas (drawing surface in memory)
            const canvas = document.createElement('canvas');
            // createElement creates a new HTML element
            
            // Get the 2D drawing context (tools to draw on canvas)
            const ctx = canvas.getContext('2d');
            // '2d' means 2D graphics (not 3D)
            
            // Set canvas dimensions (400 pixels wide, 300 pixels tall)
            canvas.width = 400;
            canvas.height = 300;
            
            // Get the user's name from the preview display
            const name = document.getElementById('previewName').textContent || 'design';
            // || 'design' provides a default if name is empty
            
            // Check if Design 1 is selected by looking for 'design1' class
            const isDesign1 = previewImage.classList.contains('design1');
            // classList.contains() returns true if class exists, false if not
            
            // Choose the image URL based on selected design
            const imageUrl = isDesign1 
                ? 'https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design1.jpg'
                : 'https://raw.githubusercontent.com/webdesigner-SA/Eid/main/design2.jpg';
            // ? : is a ternary operator (if-else in one line)
            // If isDesign1 is true, use design1.jpg URL, otherwise use design2.jpg
            
            // Create a new Image object to load the image
            const img = new Image();
            // new Image() creates an img object in JavaScript
            
            // Allow loading image from a different domain (GitHub)
            img.crossOrigin = 'anonymous';
            // This prevents CORS (Cross-Origin Resource Sharing) errors
            
        
            // When the image loads successfully
            img.onload = function() {
                // Get image dimensions
                const sw = img.width, sh = img.height;      // Source (image) width & height
                const dw = canvas.width, dh = canvas.height; // Destination (canvas) width & height
                
                // Calculate aspect ratios (width/height ratio)
                const srcRatio = sw / sh, destRatio = dw / dh;
                
                // Set default source position and size (full image)
                let sx = 0, sy = 0, sWidth = sw, sHeight = sh;
                
                // If image is wider than canvas needs
                if (srcRatio > destRatio) {
                    // Crop the sides of the image
                    sWidth = sh * destRatio;    // New width = height × canvas aspect ratio
                    sx = (sw - sWidth) / 2;    // Center crop (start from middle)
                } else {
                    // If image is taller than canvas needs
                    // Crop the top and bottom of the image
                    sHeight = sw / destRatio;  // New height = width ÷ canvas aspect ratio
                    sy = (sh - sHeight) / 2;   // Center crop (start from middle)
                }
                
                // Draw the cropped image on the canvas
                ctx.drawImage(img, sx, sy, sWidth, sHeight, 0, 0, dw, dh);
                // drawImage(image, source-x, source-y, source-width, source-height, 
                //           dest-x, dest-y, dest-width, dest-height)
                // This crops the image and stretches it to fill the canvas
                
                // Draw a semi-transparent dark overlay (makes text easier to read)
                ctx.fillStyle = 'rgba(0, 0, 0, 0.25)';  // 25% opacity black
                ctx.fillRect(0, 0, dw, dh);             // Rectangle covering entire canvas
                
                // Prepare to draw text
                ctx.fillStyle = 'white';                // White text color
                ctx.font = 'bold 48px Arial';           // Font: bold, 48 pixels, Arial
                ctx.textAlign = 'center';               // Center text horizontally
                ctx.textBaseline = 'middle';            // Center text vertically
                ctx.shadowColor = 'rgba(0, 0, 0, 0.8)'; // Black shadow (80% opacity)
                ctx.shadowBlur = 6;                     // Blur shadow by 6 pixels
                
                // Draw the user's name on the image
                ctx.fillText(name, dw / 2, dh / 2);
                // fillText(text, x-position, y-position)
                // dw/2 = center horizontally, dh/2 = center vertically
                
                // Convert canvas drawing to downloadable image
                canvas.toBlob(function(blob) {
                    // toBlob converts canvas to image file (blob = binary data)
                    
                    // Create a download URL from the image data
                    const url = URL.createObjectURL(blob);
                    
                    // Create a temporary link element for downloading
                    const a = document.createElement('a');
                    
                    // Set the download link to the image URL
                    a.href = url;
                    
                    // Set the filename (what user sees when saving)
                    a.download = `${name}_design.png`;
                    // Template literal: ${name} inserts the name variable
                    
                    // Hide the link (we don't want it visible)
                    a.style.display = 'none';
                    
                    // Add link to page (required by some browsers)
                    document.body.appendChild(a);
                    
                    // Click the link to trigger download
                    a.click();
                    
                    // Wait 150 milliseconds then clean up
                    setTimeout(function() {
                        // Remove the link from the page
                        document.body.removeChild(a);
                        
                        // Release the URL from memory (free up resources)
                        URL.revokeObjectURL(url);
                    }, 150);  // 150 milliseconds = 0.15 seconds
                });
            };
           

            // If the image fails to load (no internet or file not found)
            img.onerror = function() {
                // Draw a fallback gradient background instead
                const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
                // createLinearGradient(x1, y1, x2, y2) creates a gradient
                // From top-left (0, 0) to bottom-right (width, height)
                
                // Set gradient colors based on which design was selected
                if (isDesign1) {
                    // Design 1 colors
                    gradient.addColorStop(0, '#4b6584');   // Start color: dark blue
                    gradient.addColorStop(1, '#2c3e50');   // End color: darker blue
                } else {
                    // Design 2 colors
                    gradient.addColorStop(0, '#7d9d9c');   // Start color: teal
                    gradient.addColorStop(1, '#576f72');   // End color: darker teal
                }
                
                // Fill the entire canvas with the gradient
                ctx.fillStyle = gradient;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Add a dark overlay for text readability
                ctx.fillStyle = 'rgba(0,0,0,0.25)';
                ctx.fillRect(0, 0, canvas.width, canvas.height);
                
                // Draw the user's name
                ctx.fillStyle = 'white';
                ctx.font = 'bold 48px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText(name, canvas.width / 2, canvas.height / 2);
                
                // Download the fallback image (same process as successful load)
                canvas.toBlob(function(blob) {
                    const url = URL.createObjectURL(blob);
                    const a = document.createElement('a');
                    a.href = url;
                    a.download = `${name}_design.png`;
                    a.style.display = 'none';
                    document.body.appendChild(a);
                    a.click();
                    setTimeout(function() {
                        document.body.removeChild(a);
                        URL.revokeObjectURL(url);
                    }, 150);
                });
            };
            
            // Start loading the image from the URL
            img.src = imageUrl;
            // Setting .src triggers the image to start loading
            // When done, either onload or onerror will execute
        }
    </script>
</body>
</html>